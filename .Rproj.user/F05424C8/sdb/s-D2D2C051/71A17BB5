{
    "collab_server" : "",
    "contents" : "## Carregando os pacotes necessários\n\n## Lendo o conjunto de dados\ndata(\"mtcars\")\n\n## Criando um modelo simples\nfit <- lm(data=mtcars, mpg~drat)\n\n###########################################\n## DESCIDA DO GRADIENTE\n###########################################\nx <- mtcars$drat\ny <- mtcars$mpg\nn <- nrow(ads)\nbeta0 <- 1\nbeta1 <- 1\nalpha <- 0.1\ndelta <- 1\nyhat <- beta0 + beta1*x\nMSE <- sum((y - yhat) ^ 2) / nrow(ads)\ncost_history <- double()\ntheta_history <- list()\ncount <- 1\n\nwhile (delta >= 1e-11) {\n  \n  beta0_new <- beta0 - alpha * (1/n) * ((sum(yhat - y)))\n  beta1_new <- beta1 - alpha * (1/n) * ((sum((yhat - y)*x)))\n  beta0 <- beta0_new\n  beta1 <- beta1_new\n  yhat <- beta0 + beta1*x\n  MSE_new <- sum((y - yhat) ^ 2) / nrow(ads)\n  delta <- abs(MSE - MSE_new)\n  print(paste('delta = ', delta))\n  print(paste('Beta0 = ', beta0))\n  print(paste('Beta1 = ', beta1))\n  MSE <- MSE_new\n  theta <- c(beta0, beta1)\n  theta_history[[count]] <- theta\n  cost_history[count] <- MSE\n  count <- count + 1\n}\n\n## Plotando os modelos\nplot(x,y, col=rgb(0.2,0.4,0.6,0.4), main='Linear regression by gradient descent')\nfor (i in c(1,3,6,10,14,seq(20,1000,by=100))) {\n  abline(coef=theta_history[[i]], col=rgb(0.8,0,0,0.3))\n}\nabline(coef=theta, col='blue')\n\n## Plotando o custo\nplot(cost_history[1:100], type='line', col='blue', lwd=2, main='Cost function', ylab='cost', xlab='Iterations')\n\n###########################################\n## Usando o lm()\n###########################################\n## Sumário e tabela ANOVA\nads <- read.csv(file = 'Advertising.csv')\nfit <- lm(data = ads, sales~TV)\nsummary(fit)\nanova(fit)\n\n## R² e coeficiente de determinação\ncor(x = ads$sales, y = ads$TV)\ncor(x = ads$sales, y = ads$TV)^2\n",
    "created" : 1506060494709.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3635527485",
    "id" : "71A17BB5",
    "lastKnownWriteTime" : 1506064014,
    "last_content_update" : 1506064014955,
    "path" : "~/AP532/Aula/Aula.R",
    "project_path" : "Aula.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}